# Test database configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.devservices.enabled=true

# Test Hibernate ORM configuration
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.log.sql=true

# Disable Flyway for tests
quarkus.flyway.enabled=false

# Use same messaging configuration as dev mode - Dev Services will handle infrastructure
# Keep the same Kafka topics and channels

# For integration tests, use prod-kafka profile which has Kafka channels configured
quarkus.test.integration-test-profile=prod-kafka

# Configure Kafka for IT tests (prod-kafka profile)
%prod-kafka.kafka.bootstrap.servers=localhost:9092
%prod-kafka.quarkus.kafka.devservices.enabled=true

# Enable mockito for CDI beans
quarkus.arc.mock-enabled=true

# Seed data for tests
%test.quarkus.hibernate-orm.sql-load-script=import-test.sql

# Enable Kafka Dev Services for tests
quarkus.kafka.devservices.enabled=true
quarkus.kafka.devservices.port=0

# Enable Kafka channels for unit tests (test profile)
mp.messaging.outgoing.stickers_added.enabled=true
mp.messaging.outgoing.stickers_added.connector=smallrye-kafka
mp.messaging.outgoing.stickers_added.value.serializer=com.datadoghq.stickerlandia.common.messaging.CloudEventSerializer
mp.messaging.outgoing.stickers_updated.enabled=true
mp.messaging.outgoing.stickers_updated.connector=smallrye-kafka
mp.messaging.outgoing.stickers_updated.value.serializer=com.datadoghq.stickerlandia.common.messaging.CloudEventSerializer
mp.messaging.outgoing.stickers_deleted.enabled=true
mp.messaging.outgoing.stickers_deleted.connector=smallrye-kafka
mp.messaging.outgoing.stickers_deleted.value.serializer=com.datadoghq.stickerlandia.common.messaging.CloudEventSerializer

# S3 Dev Services configuration for tests
quarkus.s3.devservices.enabled=true
quarkus.s3.devservices.buckets=sticker-images
quarkus.s3.aws.region=us-east-1
quarkus.s3.aws.credentials.type=static
quarkus.s3.aws.credentials.static-provider.access-key-id=test-key
quarkus.s3.aws.credentials.static-provider.secret-access-key=test-secret
sticker.images.bucket=sticker-images

# Force off JSON logging to make things more readable
quarkus.log.console.json.enabled=false