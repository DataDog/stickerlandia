quarkus.openapi.generator.input-base-dir=docs
quarkus.openapi.generator.spec=api.yaml
quarkus.openapi.generator.base-package=com.datadoghq.stickerlandia.stickercatalogue

# Disable OTel exporters; we'll let Datadog plug itself in
# quarkus.otel.exporter.otlp.enabled=false
quarkus.otel.sdk.disabled=true
# Flatten MDC, so we get traceid / etc. as fields on the top level log record
quarkus.log.json.fields.mdc.flat-fields=true

# Databases
quarkus.datasource.db-kind=postgresql

# Hibernate ORM
quarkus.hibernate-orm.database.generation=validate
quarkus.hibernate-orm.log.sql=true

# Flyway
quarkus.flyway.migrate-at-start=true
quarkus.flyway.table=flyway_schema_history
quarkus.flyway.locations=db/migration

# Messaging Provider Selection (kafka or aws)
# Set via environment variable in CDK for AWS deployments
MESSAGING_PROVIDER=kafka

# S3 Configuration for sticker images
sticker.images.bucket=sticker-images

# EventBridge Configuration (used when MESSAGING_PROVIDER=aws)
# EVENT_BUS_NAME is set via environment variable in CDK
quarkus.eventbridge.aws.region=${AWS_REGION:us-east-1}
quarkus.eventbridge.aws.credentials.type=default

# Kafka channel configuration (topic names, serializers - global config)
# Channels are disabled by default to prevent Kafka client initialization in prod/AWS
# Enable in %dev profile or via env vars for docker-compose
mp.messaging.outgoing.stickers_added.enabled=false
mp.messaging.outgoing.stickers_added.topic=stickers.stickerAdded.v1
mp.messaging.outgoing.stickers_added.value.serializer=com.datadoghq.stickerlandia.common.messaging.CloudEventSerializer

mp.messaging.outgoing.stickers_updated.enabled=false
mp.messaging.outgoing.stickers_updated.topic=stickers.stickerUpdated.v1
mp.messaging.outgoing.stickers_updated.value.serializer=com.datadoghq.stickerlandia.common.messaging.CloudEventSerializer

mp.messaging.outgoing.stickers_deleted.enabled=false
mp.messaging.outgoing.stickers_deleted.topic=stickers.stickerDeleted.v1
mp.messaging.outgoing.stickers_deleted.value.serializer=com.datadoghq.stickerlandia.common.messaging.CloudEventSerializer

# ============================================================================
# Dev Profile - DevServices and SmallRye Kafka connector enablement
# ============================================================================
%dev.quarkus.datasource.devservices.enabled=true
%dev.quarkus.s3.devservices.buckets=sticker-images
%dev.quarkus.kafka.devservices.enabled=true
%dev.quarkus.kafka.devservices.topic-partitions.stickers.stickerAdded.v1=1
%dev.quarkus.kafka.devservices.topic-partitions.stickers.stickerUpdated.v1=1
%dev.quarkus.kafka.devservices.topic-partitions.stickers.stickerDeleted.v1=1

# Enable SmallRye Kafka channels in dev mode
%dev.mp.messaging.outgoing.stickers_added.enabled=true
%dev.mp.messaging.outgoing.stickers_added.connector=smallrye-kafka
%dev.mp.messaging.outgoing.stickers_updated.enabled=true
%dev.mp.messaging.outgoing.stickers_updated.connector=smallrye-kafka
%dev.mp.messaging.outgoing.stickers_deleted.enabled=true
%dev.mp.messaging.outgoing.stickers_deleted.connector=smallrye-kafka
