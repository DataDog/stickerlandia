rules:
  - id: param-used-in-repo-call
    message: "Method parameter $PARAM flows into $REPO.$METHOD"
    severity: WARNING
    languages: [java]
    mode: taint
    pattern-sources:
      - patterns:
          - pattern-inside: |
              public $RET $FUNC(..., $TYPE $PARAM, ...) { ... }
          - pattern: $PARAM
    pattern-sinks:
      - patterns:
          - pattern: $REPO.$METHOD(...)
          - metavariable-regex:
              metavariable: $REPO
              regex: '^[a-zA-Z_][a-zA-Z0-9_]*Repository$'
