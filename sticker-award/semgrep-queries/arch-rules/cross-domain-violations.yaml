rules:
  - id: sticker-to-award-domain-violation
    message: |
      Sticker domain should not import '$SUBPACKAGE.$TYPE' from the award domain. Use DTOs or events instead.
      Domain boundaries should be maintained - the sticker domain should not depend on the award domain.
    severity: WARNING
    languages: [java]
    paths:
      include:
        - "**/sticker/**/*.java"
    pattern: import com.datadoghq.stickerlandia.stickeraward.award.$SUBPACKAGE.$TYPE;

  - id: award-to-sticker-domain-violation
    message: |
      Award domain should not import '$SUBPACKAGE.$TYPE' from the sticker domain. Use DTOs or events instead.
      Domain boundaries should be maintained - the award domain should not depend on the sticker domain.
    severity: WARNING
    languages: [java]
    paths:
      include:
        - "**/award/**/*.java"
    pattern: import com.datadoghq.stickerlandia.stickeraward.sticker.$SUBPACKAGE.$TYPE;
    metadata:
      category: security
      technology: [java, domain-driven-design]
      confidence: HIGH
      impact: MEDIUM
      likelihood: MEDIUM
      subcategory: [architecture]
      cwe: "CWE-1061: Insufficient Encapsulation"
      references:
        - "https://martinfowler.com/bliki/BoundedContext.html"
        - "https://docs.microsoft.com/en-us/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/ddd-oriented-microservice"