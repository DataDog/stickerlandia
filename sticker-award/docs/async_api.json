{
  "asyncapi": "2.4.0",
  "info": {
    "title": "Sticker Award Service",
    "version": "1.0.0",
    "description": "Async API for sticker assignment events and certification integration"
  },
  "defaultContentType": "application/json",
  "channels": {
    "stickers.stickerAssignedToUser.v1": {
      "publish": {
        "operationId": "PublishStickerAssignedToUserEventV1",
        "summary": "Published when a sticker is assigned to a user",
        "message": {
          "$ref": "#/components/messages/stickerAssignedToUserEvent"
        }
      }
    },
    "stickers.stickerRemovedFromUser.v1": {
      "publish": {
        "operationId": "PublishStickerRemovedFromUserEventV1",
        "summary": "Published when a sticker is removed from a user",
        "message": {
          "$ref": "#/components/messages/stickerRemovedFromUserEvent"
        }
      }
    },
    "users.stickerClaimed.v1": {
      "publish": {
        "operationId": "PublishStickerClaimedEventV1",
        "summary": "Published when a user claims a sticker",
        "message": {
          "$ref": "#/components/messages/stickerClaimedEventV1"
        }
      }
    },
    "certifications.certificationCompleted.v1": {
      "subscribe": {
        "operationId": "ProcessCertificationCompletedEventAsync",
        "summary": "Subscribed to assign stickers based on completed certifications",
        "message": {
          "$ref": "#/components/messages/certificationCompletedEventV1"
        }
      }
    }
  },
  "components": {
    "schemas": {
      "domainEvent": {
        "id": "domainEvent",
        "type": "object",
        "x-abstract": true,
        "additionalProperties": false,
        "properties": {
          "eventName": {
            "type": "string"
          },
          "eventVersion": {
            "type": "string"
          }
        }
      },
      "stickerAssignedToUserEvent": {
        "id": "stickerAssignedToUserEvent",
        "allOf": [
          {
            "$ref": "#/components/schemas/domainEvent"
          },
          {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "eventName": {
                "type": "string",
                "const": "StickerAssignedToUser"
              },
              "eventVersion": {
                "type": "string",
                "const": "v1"
              },
              "accountId": {
                "type": "string",
                "description": "The user who was assigned the sticker"
              },
              "stickerId": {
                "type": "string",
                "description": "The sticker that was assigned"
              },
              "assignedAt": {
                "type": "string",
                "format": "date-time",
                "description": "When the assignment occurred"
              },
              "reason": {
                "type": "string",
                "nullable": true,
                "description": "Optional reason for the assignment"
              }
            },
            "required": ["eventName", "eventVersion", "accountId", "stickerId", "assignedAt"]
          }
        ]
      },
      "stickerRemovedFromUserEvent": {
        "id": "stickerRemovedFromUserEvent",
        "allOf": [
          {
            "$ref": "#/components/schemas/domainEvent"
          },
          {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "eventName": {
                "type": "string",
                "const": "StickerRemovedFromUser"
              },
              "eventVersion": {
                "type": "string",
                "const": "v1"
              },
              "accountId": {
                "type": "string",
                "description": "The user who had the sticker removed"
              },
              "stickerId": {
                "type": "string",
                "description": "The sticker that was removed"
              },
              "removedAt": {
                "type": "string",
                "format": "date-time",
                "description": "When the removal occurred"
              }
            },
            "required": ["eventName", "eventVersion", "accountId", "stickerId", "removedAt"]
          }
        ]
      },
      "stickerClaimedEventV1": {
        "id": "stickerClaimedEventV1",
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "eventName": {
            "type": "string",
            "const": "StickerClaimed"
          },
          "eventVersion": {
            "type": "string",
            "const": "v1"
          },
          "accountId": {
            "type": "string",
            "description": "The user who claimed the sticker"
          },
          "stickerId": {
            "type": "string",
            "description": "The sticker that was claimed"
          },
          "claimedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the claim occurred"
          }
        },
        "required": ["eventName", "eventVersion", "accountId", "stickerId", "claimedAt"]
      },
      "certificationCompletedEventV1": {
        "id": "certificationCompletedEventV1",
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "eventName": {
            "type": "string",
            "const": "CertificationCompleted"
          },
          "eventVersion": {
            "type": "string",
            "const": "v1"
          },
          "accountId": {
            "type": "string",
            "description": "The user who completed the certification"
          },
          "certificationId": {
            "type": "string",
            "description": "The certification that was completed"
          },
          "completedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the certification was completed"
          }
        },
        "required": ["eventName", "eventVersion", "accountId", "certificationId", "completedAt"]
      }
    },
    "messages": {
      "stickerAssignedToUserEvent": {
        "payload": {
          "$ref": "#/components/schemas/stickerAssignedToUserEvent"
        },
        "name": "stickerAssignedToUserEvent",
        "title": "Sticker Assigned to User",
        "summary": "Event published when a sticker is assigned to a user"
      },
      "stickerRemovedFromUserEvent": {
        "payload": {
          "$ref": "#/components/schemas/stickerRemovedFromUserEvent"
        },
        "name": "stickerRemovedFromUserEvent",
        "title": "Sticker Removed from User",
        "summary": "Event published when a sticker is removed from a user"
      },
      "stickerClaimedEventV1": {
        "payload": {
          "$ref": "#/components/schemas/stickerClaimedEventV1"
        },
        "name": "stickerClaimedEventV1",
        "title": "Sticker Claimed",
        "summary": "Event published when a user claims a sticker"
      },
      "certificationCompletedEventV1": {
        "payload": {
          "$ref": "#/components/schemas/certificationCompletedEventV1"
        },
        "name": "certificationCompletedEventV1",
        "title": "Certification Completed",
        "summary": "Event consumed to trigger automatic sticker assignments"
      }
    }
  }
}