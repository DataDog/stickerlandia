{
  "asyncapi": "2.4.0",
  "info": {
    "title": "Sticker Award Service",
    "version": "1.0.0"
  },
  "defaultContentType": "application/json",
  "channels": {
    "stickers.stickerAssignedToUser.v1": {
      "publish": {
        "operationId": "PublishStickerAssignedToUserEventV1",
        "summary": "Published when a sticker is assigned to a user",
        "message": {
          "$ref": "#/components/messages/stickerAssignedToUserEvent"
        }
      }
    },
    "stickers.stickerRemovedFromUser.v1": {
      "publish": {
        "operationId": "PublishStickerRemovedFromUserEventV1",
        "summary": "Published when a sticker is removed from a user",
        "message": {
          "$ref": "#/components/messages/stickerRemovedFromUserEvent"
        }
      }
    },
    "certifications.certificationCompleted.v1": {
      "subscribe": {
        "operationId": "ProcessCertificationCompletedEventAsync",
        "summary": "Subscribed to assign stickers based on completed certifications",
        "message": {
          "$ref": "#/components/messages/certificationCompletedEventV1"
        }
      }
    },
    "users.stickerClaimed.v1": {
      "publish": {
        "operationId": "PublishStickerClaimedEventV1",
        "summary": "Published when a user claims a sticker",
        "message": {
          "$ref": "#/components/messages/stickerClaimedEventV1"
        }
      }
    }
  },
  "components": {
    "schemas": {
      "cloudEventV1": {
        "id": "cloudEventV1",
        "type": "object",
        "required": ["specversion", "type", "source", "id"],
        "additionalProperties": true,
        "properties": {
          "specversion": {
            "type": "string",
            "const": "1.0"
          },
          "type": {
            "type": "string"
          },
          "source": {
            "type": "string",
            "format": "uri-reference"
          },
          "id": {
            "type": "string"
          },
          "time": {
            "type": "string",
            "format": "date-time"
          },
          "datacontenttype": {
            "type": "string",
            "default": "application/json"
          },
          "dataschema": {
            "type": "string",
            "format": "uri"
          },
          "subject": {
            "type": "string"
          },
          "data": {
            "type": "object"
          }
        }
      },
      "stickerAssignedToUserEvent": {
        "id": "stickerAssignedToUserEvent",
        "allOf": [
          {
            "$ref": "#/components/schemas/cloudEventV1"
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "const": "com.datadoghq.stickerlandia.sticker.assigned.v1"
              },
              "source": {
                "const": "/sticker-award-service"
              },
              "data": {
                "type": "object",
                "required": ["accountId", "stickerId", "assignedAt"],
                "additionalProperties": false,
                "properties": {
                  "accountId": {
                    "type": "string"
                  },
                  "stickerId": {
                    "type": "string"
                  },
                  "assignedAt": {
                    "type": "string",
                    "format": "date-time"
                  }
                }
              }
            }
          }
        ]
      },
      "stickerRemovedFromUserEvent": {
        "id": "stickerRemovedFromUserEvent",
        "allOf": [
          {
            "$ref": "#/components/schemas/cloudEventV1"
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "const": "com.datadoghq.stickerlandia.sticker.removed.v1"
              },
              "source": {
                "const": "/sticker-award-service"
              },
              "data": {
                "type": "object",
                "required": ["accountId", "stickerId", "removedAt"],
                "additionalProperties": false,
                "properties": {
                  "accountId": {
                    "type": "string"
                  },
                  "stickerId": {
                    "type": "string"
                  },
                  "removedAt": {
                    "type": "string",
                    "format": "date-time"
                  }
                }
              }
            }
          }
        ]
      },
      "certificationCompletedEventV1": {
        "id": "certificationCompletedEventV1",
        "allOf": [
          {
            "$ref": "#/components/schemas/cloudEventV1"
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "const": "com.datadoghq.stickerlandia.certification.completed.v1"
              },
              "data": {
                "type": "object",
                "required": ["accountId", "certificationId", "completedAt"],
                "additionalProperties": false,
                "properties": {
                  "accountId": {
                    "type": "string"
                  },
                  "certificationId": {
                    "type": "string"
                  },
                  "completedAt": {
                    "type": "string",
                    "format": "date-time"
                  }
                }
              }
            }
          }
        ]
      },
      "stickerClaimedEventV1": {
        "id": "stickerClaimedEventV1",
        "allOf": [
          {
            "$ref": "#/components/schemas/cloudEventV1"
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "const": "com.datadoghq.stickerlandia.sticker.claimed.v1"
              },
              "source": {
                "const": "/sticker-award-service"
              },
              "data": {
                "type": "object",
                "required": ["accountId", "stickerId"],
                "additionalProperties": false,
                "properties": {
                  "accountId": {
                    "type": "string"
                  },
                  "stickerId": {
                    "type": "string"
                  }
                }
              }
            }
          }
        ]
      }
    },
    "messages": {
      "stickerAssignedToUserEvent": {
        "payload": {
          "$ref": "#/components/schemas/stickerAssignedToUserEvent"
        },
        "name": "stickerAssignedToUserEvent"
      },
      "stickerRemovedFromUserEvent": {
        "payload": {
          "$ref": "#/components/schemas/stickerRemovedFromUserEvent"
        },
        "name": "stickerRemovedFromUserEvent"
      },
      "certificationCompletedEventV1": {
        "payload": {
          "$ref": "#/components/schemas/certificationCompletedEventV1"
        },
        "name": "certificationCompletedEventV1"
      },
      "stickerClaimedEventV1": {
        "payload": {
          "$ref": "#/components/schemas/stickerClaimedEventV1"
        },
        "name": "stickerClaimedEventV1"
      }
    }
  }
}